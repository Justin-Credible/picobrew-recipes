/* Taken from: https://www.picobrew.com/Bundles/Scripts/PublicRecipesJS?v=1SwlxyXkIThSrYIB6CtTYA98aP_xsU0SC9yLuCKpYRE1 */
const genericBlob="https://pbcdn.blob.core.windows.net/image/Generic/",recipe_sort_vm={title:"SORT",button:{img:genericBlob+"sort.svg"},closeimg:genericBlob+"x_white.svg",up:genericBlob+"up_white.svg",down:genericBlob+"down_white.svg",items:["Recipe Name","Beer Style","Author Name","ABV","IBU","SRM","OG","FG","Rating"],by:"Recipe Name",ascended_sort:!0,active:!1},recipe_filter_vm={title:"FILTER",button:{img:genericBlob+"filter.svg",style:"margin-right: .5rem;"},closeimg:genericBlob+"x_white.svg",search:{beer:{include:!0,title:"Recipe Name"},author:{include:!0,title:"Author Name"},tasting:{include:!0,title:"Tasting Notes"},style:{include:!0,title:"Beer Style"},grains:{include:!1,title:"Grains"},hops:{include:!1,title:"Hops"}},ranges:{abv:{title:"ABV",range:{step:"0.1",low:"",high:""}},ibu:{title:"IBU",range:{step:"1",low:"",high:""}},srm:{title:"SRM",range:{step:"1",low:"",high:""}}},active:!1};Vue.component("rounded-image-button",{props:{vm:{}},template:'<div class="rounded-image-button" :class="vm.class" :style="vm.style" v-on:click.stop="handleClick"><img :src="vm.img"><\/div>',methods:{handleClick:function(){this.$emit("button-event")}}});Vue.component("filter-container",{props:{vm:{}},template:'<div class="filter-container" :class="{ \'-active\': vm.active }" v-on:mouseleave="mouseLeave">                   <div class="filter-container--header">                       <div>{{ vm.title }}<\/div>                       <div class="filter-container--close" v-on:click.stop="closeClick"><\/div>                   <\/div>                   <div v-if="vm.search" class="filter-container--section">                       <div class="filter-container--section-title">Include in Search<\/div>                       <div class="filter-container--search-item" v-for="item in vm.search">                          <input class="-checkbox" type="checkbox" v-model="item.include"  >                          <div class="-itemtitle">{{ item.title }}<\/div>                       <\/div>                   <\/div>                   <div v-if="vm.ranges" class="filter-container--section">                       <div class="filter-container--section-title">Range Filters<\/div>                       <div class="filter-container--range-item" v-for="item in vm.ranges">                          <div class="-title">{{ item.title }}<\/div>                          <input class="-numberinput" type="number" :step="item.range.step" v-model.number="item.range.low">                          <div class="-subtitle">TO<\/div>                          <input class="-numberinput" type="number" v-model.number="item.range.high">                       <\/div>                   <\/div>                   <div class="filter-container--reset" v-on:click="resetClick">RESET FILTERS<\/div>               <\/div>',methods:{mouseLeave:function(){this.$emit("mouse-leave-event")},closeClick:function(){this.$emit("filter-close-event")},resetClick:function(){this.$emit("filter-reset-event")}}});Vue.component("sort-container",{props:{vm:{}},template:'<div class="sort-container" :class="{ \'-active\': vm.active }" v-on:mouseleave="mouseLeave">                   <div class="sort-container--header">                       <div>{{ vm.title }}<\/div>                       <div class="sort-container--close" v-on:click.stop="closeClick"><\/div>                   <\/div>                   <div>                       <div class="sort-container--item" v-for="item in vm.items" :class="{ \'selected\' : vm.by == item }" v-on:click.stop="itemClick(item)">                           <div>{{ item }}<\/div>                           <img v-show="item == vm.by && vm.ascended_sort" :src="vm.up" />                           <img v-show="item == vm.by && !vm.ascended_sort" :src="vm.down" />                       <\/div>                   <\/div>               <\/div>',methods:{mouseLeave:function(){this.$emit("mouse-leave-event")},itemClick:function(n){this.$emit("sort-item-event",n)},closeClick:function(){this.$emit("sort-close-event")}}});Vue.component("recipe-stats",{props:{vm:[],statstyle:"",boxstyle:""},template:'<div v-if="vm && vm.length >= 2" class="recipe-stats" :class="boxstyle">                     <div v-for="(stat, index) in vm" class="recipe-stats--stat" :class="[styleSet(index), boxstyle]">                         <div class="-title">{{ stat.Title }}<\/div>                         <div class="-stat">{{  stat.Stat }}<\/div>                     <\/div>                 <\/div>',methods:{styleSet:function(n){return this.statstyle=="feature"&&n==1?"-right":""}}});Vue.component("featured-recipes",{data:function(){return{scrollStart:!0,scrollEnd:!1,scrollOffset:2}},props:{vm:{}},template:'<div v-if="vm && vm.FeaturedRecipes && vm.FeaturedRecipes.length > 0" class="featured-recipes">                    <div class="featured-recipes--title">{{ vm.Title }}<\/div>                    <div class="featured-recipes--recipes">                        <div v-if="!scrollStart"  class="featured-recipes--fade -left"><\/div>                        <div v-if="!scrollEnd"    class="featured-recipes--fade -right"><\/div>                        <div v-on:scroll="scrollListener" class="featured-recipes--scroll">                            <featured-recipe v-for="recipe in vm.FeaturedRecipes" :vm="recipe"><\/featured-recipe>                        <\/div>                    <\/div>                <\/div>',methods:{scrollListener:function(n){var t=n.target,i=t.scrollWidth-t.clientWidth-this.scrollOffset;this.scrollStart=t.scrollLeft<this.scrollOffset?!0:!1;this.scrollEnd=t.scrollLeft>i?!0:!1}}});Vue.component("featured-recipe",{props:{vm:{}},template:'<a :href="vm.Link" class="featured-recipe">                    <div class="recipe--img"><img :src="vm.Img" /><\/div>                    <div class="recipe--titles">                        <div class="recipe--title">{{ vm.Title }}<\/div>                        <div class="recipe--subtitle">{{ vm.Subtitle }}<\/div>                    <\/div>                    <recipe-stats :vm="vm.Stats" :style="\'feature\'"><\/recipe-stats>                <\/a>'});Vue.component("recipe-row",{data:function(){return{extended:!1,screenwidth:375,characterMax:{800:60,900:95,1e3:110,1100:130,1200:145}}},props:{vm:{}},template:'<div class="recipe-row" v-on:click="handleRowClick">                   <div class="recipe-row--main">                     <div class="recipe--img -row"><img :src="vm.Img" /><\/div>                      <div class="recipe--titles -row">                         <div class="recipe--subtitle -author -row">By {{ vm.Author }}<\/div>                         <div>                            <div class="recipe--title -row">{{ vm.Title }}<\/div>                            <div class="recipe--subtitle -row">{{ vm.Subtitle }}<\/div>                         <\/div>                      <\/div>                      <div class="recipe-row--description-main">                          <div class="recipe-row--description-title">tasting notes<\/div>                          <div>{{ maindescription }}<\/div>                      <\/div>                      <div class="recipe-row--stat-block">                         <div class="recipe-row--stars"><img :src="vm.RatingImg" /><\/div>                         <recipe-stats :vm="mainstats" :boxstyle="\'-row\'"><\/recipe-stats>                      <\/div>                   <\/div>                   <div v-if="extended" class="recipe-row--extend">                      <div class="recipe-row--extend-description">                           <div class="recipe-row--description-title">tasting notes<\/div>                           <div class="recipe-row--description">{{ vm.Description }}<\/div>                       <\/div>                       <recipe-stats :vm="vm.Stats.slice(2)" :boxstyle="\'-left\'"><\/recipe-stats>                       <a :href="vm.Link" v-on:click.stop="emptyStub" class="recipe-row--button"><div class="-buttontext">VIEW RECIPE<\/div><\/a>                   <\/div>                <\/div>',computed:{maindescription:function(){var t=this.screenwidth>=1300?1200:100*Math.floor(this.screenwidth/100),n=this.characterMax[t];return this.vm.Description.length>=n?this.vm.Description.substring(0,n)+"...":this.vm.Description},mainstats:function(){return this.screenwidth>=800?this.vm.Stats:this.vm.Stats.slice(0,2)}},methods:{resizeHandler:function(){this.extended=!1;this.screenwidth=window.innerWidth},emptyStub:function(){},handleRowClick:function(){this.screenwidth<800?this.extended=!this.extended:window.open(this.vm.Link)}},mounted:function(){var n=this;n.resizeHandler();window.addEventListener("resize",n.resizeHandler)}});new Vue({el:"#public-recipes-app",data:function(){return{pageIndex:0,publicRecipes:[],filtered:[],restApiUrl:"",searchInput:"",sortvm:recipe_sort_vm,filtervm:JSON.parse(JSON.stringify(recipe_filter_vm)),featuredvm:{},perPage:15,loaded:!1}},computed:{getFilteredRecipes:function(){var n=this;return n.publicRecipes.filter(function(t){return n.applyFilters(t)}).filter(function(t){var i=n.searchInput.toLowerCase();return n.applySearch(t,i)}).sort(n.compare)},getFilteredRecipesSlice:function(){return this.getFilteredRecipes.slice(this.pageIndex,this.pageIndex+this.perPage)},getFilteredRecipesLength:function(){return this.getFilteredRecipes.length},getPublicRecipesLength:function(){return this.publicRecipes.length},getWindowWidth:function(){return window.innerWidth}},methods:{applyFilters:function(n){var t=n.ABV>=this.filtervm.ranges.abv.range.low&&(isNullOrEmpty(this.filtervm.ranges.abv.range.high)||n.ABV<=this.filtervm.ranges.abv.range.high),i=n.IBU>=this.filtervm.ranges.ibu.range.low&&(isNullOrEmpty(this.filtervm.ranges.ibu.range.high)||n.IBU<=this.filtervm.ranges.ibu.range.high),r=n.SRM>=this.filtervm.ranges.srm.range.low&&(isNullOrEmpty(this.filtervm.ranges.srm.range.high)||n.SRM<=this.filtervm.ranges.srm.range.high);return t&&i&&r},applySearch:function(n,t){var i=this;return i.filtervm.search.beer.include&&n.Name.toLowerCase().includes(t)||i.filtervm.search.author.include&&n.Author.toLowerCase().includes(t)||i.filtervm.search.style.include&&n.Style.toLowerCase().includes(t)||i.filtervm.search.tasting.include&&n.Description.toLowerCase().includes(t)||i.filtervm.search.grains.include&&i.filterGrains(n,t)||i.filtervm.search.hops.include&&i.filterHops(n,t)},resetPageIndex:function(){this.pageIndex=0},setData:function(){const n=this;this.getData().then(function(t){n.styles=t.data.BeerStyles.sort();n.publicRecipes=t.data.PublicRecipesList.sort(this.compare);n.loaded=!0})},getData:function(){return axios.get(this.restApiUrl)},sort:function(n){this.sortvm.by===n?this.sortvm.ascended_sort=!this.sortvm.ascended_sort:(this.sortvm.by=n,this.sortvm.ascended_sort=n=="Rating"?!1:!0)},compare:function(n,t){var i=null,r=null;switch(this.sortvm.by){case"Recipe Name":i=n.Name.toLowerCase();r=t.Name.toLowerCase();break;case"Author Name":i=n.Author.toLowerCase();r=t.Author.toLowerCase();break;case"Beer Style":i=n.Style.toLowerCase();r=t.Style.toLowerCase();break;case"OG":i=n.OG;r=t.OG;break;case"FG":i=n.FG;r=t.FG;break;case"SRM":i=n.SRM;r=t.SRM;break;case"ABV":i=n.ABV;r=t.ABV;break;case"IBU":i=n.IBU;r=t.IBU;break;case"Rating":i=n.Average;r=t.Average;break;default:i=n.Name.toLowerCase();r=t.Name.toLowerCase()}let u=0;return i>r?u=this.sortvm.ascended_sort?1:-1:i<r&&(u=this.sortvm.ascended_sort?-1:1),u},filterGrains:function(n,t){if(!n.Grains)return!1;var i=!0;return t.split(",").forEach(function(t){n.Grains.toLowerCase().includes(t)||(i=!1)}),i},filterHops:function(n,t){if(!n.Hops)return!1;var i=!0;return t.split(",").forEach(function(t){n.Hops.toLowerCase().includes(t)||(i=!1)}),i},setRestUrl:function(n){this.restApiUrl=n},createRecipeRowVM:function(n){return{Title:n.Name,Subtitle:n.Style,Author:n.Author,Description:n.Description,Stats:[{Title:"ABV",Stat:""+n.ABV.toFixed(1)+"%"},{Title:"IBU",Stat:""+n.IBU.toFixed(0)},{Title:"OG",Stat:""+n.OG.toFixed(3)},{Title:"FG",Stat:""+n.FG.toFixed(3)},{Title:"SRM",Stat:""+n.SRM.toFixed(0)}],Img:GetSmallSRMImage(n.SRM),RatingImg:GetStarsImage(n.Average),Link:getPublicRecipeHref(n.GUID),GUID:n.GUID}},createCardList:function(n){var t=[],i=this;return n.forEach(function(n){t.push(i.createRecipeRowVM(n))}),t},showSort:function(n){this.filtervm.active=!1;this.sortvm.active=n},showFilter:function(n){this.sortvm.active=!1;this.filtervm.active=n},handleFilterReset:function(){var n=JSON.parse(JSON.stringify(recipe_filter_vm));n.active=!0;this.filtervm=n}},mounted:function(){this.setData();this.featuredvm=featuredrecipes}})